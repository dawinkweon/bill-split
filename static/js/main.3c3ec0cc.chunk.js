(this["webpackJsonpbill-split"]=this["webpackJsonpbill-split"]||[]).push([[0],{19:function(t,e,n){},25:function(t,e,n){},98:function(t,e,n){"use strict";n.r(e);var c=n(0),a=n.n(c),r=n(20),o=n.n(r),i=(n(25),n(9)),s=n(16),u=n(11),l=n(5),j=n(8),d=n.n(j),b=n(12),m=(n(19),n(96),n(4)),p=function(t){var e=Object(c.useState)(""),n=Object(u.a)(e,2),a=n[0],r=n[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Input,{className:"new-person-input",placeholder:"New Person",value:a,onChange:function(t){r(t.target.value)}})}),Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Button,{onClick:function(){""!==a&&(t.onNewPersonAdded(a),r(""))},children:"\u2795"})})]})},O=function(t){var e=t.item,n=t.onItemChanged,c=e.rowId,a=e.name,r=e.amount,o=e.splitBy,s=d.a.sortBy(o,"person.colId");return Object(m.jsxs)(l.Tr,{children:[Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Input,{className:"item-name-input",value:e.name,placeholder:"New item",onChange:function(t){return e=t.target.value,void n(c,e,r,o);var e}})}),Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Input,{className:"amount-input",value:e.amount,type:"number",onFocus:function(t){return t.target.select()},onChange:function(t){return function(t){var e=parseFloat(t);n(c,a,e,o)}(t.target.value)}})}),s.map((function(t){return Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Input,{className:"ratio-input",value:t.ratio,type:"number",onFocus:function(t){return t.target.select()},onChange:function(e){return function(t,e){var s=parseFloat(e);isNaN(s)&&(s=0),console.log(s);var u=[].concat(Object(i.a)(o.filter((function(e){return e.person.colId!==t.colId}))),[{person:t,ratio:s}]);n(c,a,r,u)}(t.person,e.target.value)}})},t.person.colId)}))]})},f=function(){var t=Object(c.useState)([]),e=Object(u.a)(t,2),n=e[0],a=e[1],r=Object(c.useState)([]),o=Object(u.a)(r,2),j=o[0],f=o[1];Object(c.useEffect)((function(){a(Object(b.get)("billItems")||[]),f(Object(b.get)("people")||[])}),[]),Object(c.useEffect)((function(){Object(b.set)("billItems",n),Object(b.set)("people",j)}),[n,j]);var h=function(){var t=d.a.max(n.map((function(t){return t.rowId})));return{rowId:void 0!==t?t+1:0,name:"",amount:0,splitBy:j.map((function(t){return{person:t,ratio:0}}))}},x=function(t,e,c,r){if(console.log("onItemChanged with params [".concat(t,", ").concat(e,", ").concat(c,", ").concat(JSON.stringify(r),"]")),d.a.find(n,["rowId",t])){var o={rowId:t,name:e,amount:c,splitBy:r};a([].concat(Object(i.a)(n.filter((function(e){return e.rowId!==t}))),[o]))}},g=d.a.sortBy(n,"rowId"),I=function(){var t=d.a.sum(n.map((function(t){return t.amount}))),e=g.map((function(t){return d.a.sortBy(t.splitBy,"person.colId").map((function(e){return e.ratio/d.a.sum(t.splitBy.map((function(t){return t.ratio})))}))}));return{totalAmount:t,splitTotals:d.a.zip.apply(d.a,Object(i.a)(e)).map((function(t){var e=t.map((function(t,e){return(void 0===t||isNaN(t)?0:t)*g[e].amount}));return d.a.sum(e)}))}}(),v=I.totalAmount!==d.a.sum(I.splitTotals),T=n.length>0||j.length>0;return Object(m.jsxs)(l.Container,{className:"root",children:[Object(m.jsx)(l.Title,{children:"Split bills"}),Object(m.jsxs)(l.Table.Container,{children:[Object(m.jsxs)(l.Table,{children:[Object(m.jsxs)(l.Thead,{children:[Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Label,{children:"Item name"})}),Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Label,{children:"Amount"})}),j.map((function(t){return Object(m.jsx)(l.Td,{children:t.name},t.colId)})),Object(m.jsx)(p,{onNewPersonAdded:function(t){var e=d.a.max(j.map((function(t){return t.colId}))),c={colId:void 0!==e?e+1:0,name:t},r=n.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{splitBy:[].concat(Object(i.a)(t.splitBy),[{person:c,ratio:0}])})}));a(r),f([].concat(Object(i.a)(j),[c]))}})]}),Object(m.jsx)(l.Tbody,{children:g.map((function(t){return Object(m.jsx)(O,{item:t,onItemChanged:x},t.rowId)}))}),Object(m.jsxs)(l.Tfoot,{children:[Object(m.jsx)(l.Tr,{className:"add-item-row",children:Object(m.jsx)(l.Button,{onClick:function(){a([].concat(Object(i.a)(n),[h()]))},children:"\u2795"})}),I.totalAmount>0&&function(t){return Object(m.jsxs)(l.Tr,{className:"summary-row",hasBackgroundDangerLight:v,hasBackgroundSuccessLight:!v,children:[Object(m.jsx)(l.Td,{children:Object(m.jsx)(l.Label,{children:"Total"})}),Object(m.jsx)(l.Td,{children:Object(m.jsxs)(l.Label,{children:["$",t.totalAmount]})}),t.splitTotals.map((function(t){return Object(m.jsx)(l.Td,{children:Object(m.jsxs)(l.Label,{children:["$",t.toFixed(2)]})})}))]})}(I)]})]}),T&&Object(m.jsx)("a",{className:"is-pulled-right",onClick:function(){a([]),f([])},children:"Clear table"})]})]})},h=function(){return Object(m.jsx)(f,{})},x=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,99)).then((function(e){var n=e.getCLS,c=e.getFID,a=e.getFCP,r=e.getLCP,o=e.getTTFB;n(t),c(t),a(t),r(t),o(t)}))};o.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(h,{})}),document.getElementById("root")),x()}},[[98,1,2]]]);
//# sourceMappingURL=main.3c3ec0cc.chunk.js.map